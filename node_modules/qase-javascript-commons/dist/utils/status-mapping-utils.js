"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.applyStatusMapping = applyStatusMapping;
exports.validateStatusMapping = validateStatusMapping;
const test_execution_1 = require("../models/test-execution");
/**
 * Applies status mapping configuration to a test status
 * @param status - Original test status
 * @param statusMapping - Status mapping configuration
 * @returns Mapped test status or original if no mapping found
 */
function applyStatusMapping(status, statusMapping) {
    if (!statusMapping) {
        return status;
    }
    const mappedStatus = statusMapping[status];
    if (!mappedStatus) {
        return status;
    }
    // Validate that the mapped status is a valid TestStatusEnum value
    const validStatuses = Object.values(test_execution_1.TestStatusEnum);
    if (!validStatuses.includes(mappedStatus)) {
        console.warn(`Invalid status mapping: "${status}" -> "${mappedStatus}". Valid statuses are: ${validStatuses.join(', ')}`);
        return status;
    }
    return mappedStatus;
}
/**
 * Validates status mapping configuration
 * @param statusMapping - Status mapping configuration to validate
 * @returns Array of validation errors (empty if valid)
 */
function validateStatusMapping(statusMapping) {
    const errors = [];
    const validStatuses = Object.values(test_execution_1.TestStatusEnum);
    for (const [fromStatus, toStatus] of Object.entries(statusMapping)) {
        if (!validStatuses.includes(fromStatus)) {
            errors.push(`Invalid source status "${fromStatus}". Valid statuses are: ${validStatuses.join(', ')}`);
        }
        if (!validStatuses.includes(toStatus)) {
            errors.push(`Invalid target status "${toStatus}". Valid statuses are: ${validStatuses.join(', ')}`);
        }
    }
    return errors;
}
